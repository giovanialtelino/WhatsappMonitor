@page "/beingUploaded"

@inject Services.ApiService apiServices
@using WhatsappMonitor.Shared.Models;

<hr/>

@if(uploads == null)
{
<p>Loading....</p>
}
else
{
    @if(uploads.Count > 0)
    {
<div style="justify-content: center;" class="form-row">
    <h2>Uploads waiting to be indexed</h2>
</div>
    }
    else{
<div style="justify-content: center;" class="form-row">
    <h2>No File to be Indexed</h2>
</div>
    }
    
@foreach (var i in uploads)
    {
<li class="list-group-item">
    <form>
        <div class="form-row">
            <div class="form-group col-md-2">
                <label for="">Upload Date</label>
                <input class="form-control" type="text" @bind="i.CreationDate">
            </div>
            <div class="form-group col-md-8">
                <label for="">File Name</label>
                <input class="form-control" type="text" @bind="i.FileName">
            </div>
            <div class="form-group col-md-2">
                <label for="">In Process</label>
                <input class="form-control" type="text" @bind="i.InProcess">
            </div>
        </div>
    </form>
</li>
<br>
    }

    <hr/>
}

@code {
    [Parameter]
    public int Id { get; set; }
    List<Upload> uploads;

    protected override async Task OnInitializedAsync()
    {
        await GetUploadsWaiting();
    }

    public async Task GetUploadsWaiting()
    {
        uploads = await apiServices.UploadWaiting(Id);
    }    
}